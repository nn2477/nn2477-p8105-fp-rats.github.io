---
title: "descriptive"
output: html_document
date: "2023-12-07"
---

```{r, message=FALSE, echo=FALSE}
library(tidyverse)

rat_sightings_data <- read.csv("./datasets_clean/rat_sightings_data")
population_individual_data <- read.csv("./datasets_clean/population_individual_data")
population_totals_data <- read.csv("./datasets_clean/population_totals_data")
income_data_2020 <- read.csv("./datasets_clean/income_data_2020")
```

# Rat Sightings Data

## Frequency Table

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_freq = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(Year = year_created) %>% 
  pivot_wider(
    names_from = borough,
    values_from = count
  )

knitr::kable(avg_rat_sightings_freq)
```

## Measures of Central Tendency

Measures of Central Tendency for Rat Sightings by Year

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_numeric = 
  avg_rat_sightings_box%>%
  summarise(
    mean = mean(count),
    median = median(count),
    sd = sd(count),
    min = min(count),
    max = max(count)
  )

knitr::kable(summary_stats_numeric)
```

Measures of Central Tendency for Rat Sightings by Borough (2015-2020)

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_borough = 
  avg_rat_sightings_box%>%
  group_by(borough) %>% 
  summarise(
    mean = mean(count),
    median = median(count),
    sd = sd(count),
    min = min(count),
    max = max(count)
  )

knitr::kable(summary_stats_borough)
```

## Measures of Dispersion 

Measures of Dispersion for Rat Sightings by Year

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

dispersion_stats = 
  avg_rat_sightings_box %>%
  summarise(
    range = max(count) - min(count),
    iqr = IQR(count),
    sd = sd(count),
    var = var(count)
  )

knitr::kable(dispersion_stats)
```

Measures of Dispersion for Rat Sightings by Borough (2015-2020)

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_borough = 
  avg_rat_sightings_box%>%
  group_by(borough) %>% 
  summarise(
    range = max(count) - min(count),
    iqr = IQR(count),
    sd = sd(count),
    var = var(count)
  )

knitr::kable(summary_stats_borough)
```

## Quartiles

Quartiles for Rat Sightings by Year

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

quartiles_quantile =
avg_rat_sightings_box %>%
  summarise(
    Q1 = quantile(count, 0.25),
    median = median(count),
    Q3 = quantile(count, 0.75)
  )

knitr::kable(quartiles_quantile)
```

Quartiles for Rat Sightings by Borough (2015-2020)

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

quartiles_quantile_borough = 
  avg_rat_sightings_box %>%
  group_by(borough) %>% 
  summarise(
    Q1 = quantile(count, 0.25),
    median = median(count),
    Q3 = quantile(count, 0.75)
  )

knitr::kable(quartiles_quantile_borough)
```



# Income Data

## Frequency Table

Highest Frequency Median Income by Borough in 2020

```{r, message=FALSE, echo=FALSE}
med_income_freq = 
  income_data_2020 %>% 
  group_by(borough, median_income) |> 
  summarize(count = n()) |> 
  arrange(borough, desc(count)) |> 
  slice_head(n = 1) |> 
  select(-count) |> 
  pivot_wider(
    names_from = borough,
    values_from = median_income
  )

knitr::kable(med_income_freq)
```

## Measures of Central Tendency

Measures of Central Tendency for Median Income by Borough in 2020

```{r, message=FALSE, echo=FALSE}
central_tend_med_income = 
  income_data_2020 %>% 
  group_by(borough) |> 
  summarise(
    mean = mean(median_income),
    median = median(median_income),
    sd = sd(median_income),
    min = min(median_income),
    max = max(median_income)
  )

knitr::kable(central_tend_med_income)
```

## Measures of Dispersion

Measures of Dispersion for Median Income by Borough in 2020

```{r, message=FALSE, echo=FALSE}
disp_med_income = 
  income_data_2020 %>%
  group_by(borough) %>% 
  summarise(
    range = max(median_income) - min(median_income),
    iqr = IQR(median_income),
    sd = sd(median_income),
    var = var(median_income)
  )

knitr::kable(disp_med_income)
```

## Quartiles

Quartiles for Median Income by Borough in 2020

```{r, message=FALSE, echo=FALSE}
quartiles_med_income = 
  income_data_2020 %>%
  group_by(borough) %>% 
  summarise(
    Q1 = quantile(median_income, 0.25),
    median = median(median_income),
    Q3 = quantile(median_income, 0.75)
  )

knitr::kable(quartiles_med_income)
```



# Population Data

## Frequency Table

```{r, message=FALSE, echo=FALSE}
pop_freq =
  population_individual_data |> 
  group_by(borough) |> 
  summarise(total_population = sum(population)) |> 
  pivot_wider(
    names_from = borough,
    values_from = total_population
  )

knitr::kable(pop_freq)
```

## Measures of Central Tendency

Measures of Central Tendency for Population by Borough

```{r, message=FALSE, echo=FALSE}
central_tend_pop = 
  population_individual_data %>% 
  group_by(borough) |> 
  summarise(
    mean = mean(population),
    median = median(population),
    sd = sd(population),
    min = min(population),
    max = max(population)
  )

knitr::kable(central_tend_pop)
```

## Measures of Dispersion

Measures of Dispersion for Population by Borough

```{r, message=FALSE, echo=FALSE}
disp_pop = 
  population_individual_data %>%
  group_by(borough) |> 
  summarise(
    range = max(population) - min(population),
    iqr = IQR(population),
    sd = sd(population),
    var = var(population)
  )

knitr::kable(disp_pop)
```

## Quartiles

Quartiles for Population by Borough

```{r, message=FALSE, echo=FALSE}
quartiles_pop = 
  population_individual_data %>%
  group_by(borough) |> 
  summarise(
    Q1 = quantile(population, 0.25),
    median = median(population),
    Q3 = quantile(population, 0.75)
  )

knitr::kable(quartiles_pop)
```