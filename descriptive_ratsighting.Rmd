---
title: Rat Sighting Data 
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r, message=FALSE, echo=FALSE}
library(tidyverse)

rat_sightings_data <- read.csv("./datasets_clean/rat_sightings_data")
population_individual_data <- read.csv("./datasets_clean/population_individual_data")
population_totals_data <- read.csv("./datasets_clean/population_totals_data")
income_data_2020 <- read.csv("./datasets_clean/income_data_2020")
```


### Frequency Table

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_freq = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(Year = year_created) %>% 
  pivot_wider(
    names_from = borough,
    values_from = count
  )

knitr::kable(avg_rat_sightings_freq)
```

### Measures of Central Tendency

**Measures of Central Tendency for Rat Sightings by Year**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_numeric = 
  avg_rat_sightings_box%>%
  summarise(
    mean = mean(count),
    median = median(count),
    sd = sd(count),
    min = min(count),
    max = max(count)
  )

knitr::kable(summary_stats_numeric)
```

**Measures of Central Tendency for Rat Sightings by Borough (2015-2020)**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_borough = 
  avg_rat_sightings_box%>%
  group_by(borough) %>% 
  summarise(
    mean = mean(count),
    median = median(count),
    sd = sd(count),
    min = min(count),
    max = max(count)
  )

knitr::kable(summary_stats_borough)
```

### Measures of Dispersion 

**Measures of Dispersion for Rat Sightings by Year**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

dispersion_stats = 
  avg_rat_sightings_box %>%
  summarise(
    range = max(count) - min(count),
    iqr = IQR(count),
    sd = sd(count),
    var = var(count)
  )

knitr::kable(dispersion_stats)
```

**Measures of Dispersion for Rat Sightings by Borough (2015-2020)**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

summary_stats_borough = 
  avg_rat_sightings_box%>%
  group_by(borough) %>% 
  summarise(
    range = max(count) - min(count),
    iqr = IQR(count),
    sd = sd(count),
    var = var(count)
  )

knitr::kable(summary_stats_borough)
```

### Quartiles

**Quartiles for Rat Sightings by Year**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

quartiles_quantile =
avg_rat_sightings_box %>%
  summarise(
    Q1 = quantile(count, 0.25),
    median = median(count),
    Q3 = quantile(count, 0.75)
  )

knitr::kable(quartiles_quantile)
```

**Quartiles for Rat Sightings by Borough (2015-2020)**

```{r, message=FALSE, echo=FALSE}
avg_rat_sightings_box = 
  rat_sightings_data %>% 
  mutate(unique_key = as_factor(unique_key)) %>% 
  group_by(year_created, borough) %>% 
  summarize(count = n_distinct(unique_key)) %>% 
  rename(year = year_created)

quartiles_quantile_borough = 
  avg_rat_sightings_box %>%
  group_by(borough) %>% 
  summarise(
    Q1 = quantile(count, 0.25),
    median = median(count),
    Q3 = quantile(count, 0.75)
  )

knitr::kable(quartiles_quantile_borough)
```
